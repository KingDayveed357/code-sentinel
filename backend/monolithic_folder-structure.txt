codesentinel/
├── src/
│   ├── modules/                        # Feature modules (vertical slices)
│   │   ├── auth/
│   │   │   ├── routes.ts              # HTTP endpoints
│   │   │   ├── service.ts             # Business logic
│   │   │   ├── schemas.ts             # Validation
│   │   │   └── types.ts
│   │   │
│   │   ├── repositories/
│   │   │   ├── routes.ts
│   │   │   ├── service.ts
│   │   │   ├── schemas.ts
│   │   │   └── types.ts
│   │   │
│   │   ├── scans/
│   │   │   ├── routes.ts
│   │   │   ├── service.ts             # Orchestrates scan jobs
│   │   │   ├── worker.ts              # Background job processor
│   │   │   ├── schemas.ts
│   │   │   └── types.ts
│   │   │
│   │   ├── vulnerabilities/
│   │   │   ├── routes.ts
│   │   │   ├── service.ts
│   │   │   ├── schemas.ts
│   │   │   └── types.ts
│   │   │
│   │   └── integrations/
│   │       ├── routes.ts
│   │       ├── github-service.ts
│   │       ├── gitlab-service.ts
│   │       └── types.ts
│   │
│   ├── scanners/                      # Scanner implementations (shared)
│   │   ├── base/
│   │   │   └── scanner-interface.ts  # Base class
│   │   │
│   │   ├── sast/
│   │   │   ├── semgrep.ts            # Semgrep wrapper
│   │   │   ├── parser.ts             # Normalize output
│   │   │   └── types.ts
│   │   │
│   │   ├── sca/
│   │   │   ├── osv.ts
│   │   │   ├── parser.ts
│   │   │   └── types.ts
│   │   │
│   │   ├── secrets/
│   │   │   ├── gitleaks.ts
│   │   │   ├── parser.ts
│   │   │   └── types.ts
│   │   │
│   │   ├── iac/
│   │   │   ├── checkov.ts
│   │   │   ├── parser.ts
│   │   │   └── types.ts
│   │   │
│   │   ├── container/
│   │   │   ├── trivy.ts
│   │   │   ├── parser.ts
│   │   │   └── types.ts
│   │   │
│   │   └── orchestrator.ts           # Runs all scanners in parallel
│   │
│   ├── ai/                            # AI reasoning (in-process)
│   │   ├── client.ts                 # Gemini API client
│   │   ├── enrichment.ts             # Explain findings
│   │   ├── deduplication.ts          # Merge similar issues
│   │   ├── prioritization.ts         # Risk scoring
│   │   ├── prompts.ts                # Prompt templates
│   │   └── types.ts
│   │
│   ├── shared/                        # Cross-cutting concerns
│   │   ├── db/
│   │   │   ├── supabase.ts           # Supabase client
│   │   │   └── types.ts              # Database types
│   │   │
│   │   ├── git/
│   │   │   ├── github-client.ts
│   │   │   ├── gitlab-client.ts
│   │   │   └── fetcher.ts            # Fetch repo code
│   │   │
│   │   ├── queue/
│   │   │   ├── job-queue.ts          # BullMQ wrapper
│   │   │   └── types.ts
│   │   │
│   │   ├── utils/
│   │   │   ├── retry.ts
│   │   │   ├── rate-limit.ts
│   │   │   ├── logger.ts
│   │   │   └── validation.ts
│   │   │
│   │   └── types/
│   │       ├── vulnerability.ts      # Unified vulnerability schema
│   │       ├── scan.ts
│   │       └── repository.ts
│   │
│   ├── plugins/                       # Fastify plugins
│   │   ├── supabase.ts
│   │   ├── auth.ts
│   │   ├── rate-limit.ts
│   │   └── error-handler.ts
│   │
│   ├── middleware/
│   │   ├── authenticate.ts
│   │   ├── validate-plan.ts
│   │   └── audit-log.ts
│   │
│   ├── server.ts                      # Main app entry point
│   ├── env.ts                         # Environment config
│   └── index.ts                       # Start server
│
├── database/
│   ├── migrations/                    # SQL migrations
│   │   ├── 001_initial_schema.sql
│   │   ├── 002_add_scanner_fields.sql
│   │   └── 003_add_audit_logs.sql
│   │
│   └── seed.ts                        # Test data
│
├── scripts/
│   ├── dev.sh                         # Start dev server
│   ├── setup.sh                       # Install scanners
│   └── test-scan.sh                   # Run test scan
│
├── docker/
│   ├── Dockerfile                     # Single image for app
│   ├── docker-compose.yml             # App + Redis + Postgres (optional)
│   └── .dockerignore
│
├── tests/
│   ├── unit/
│   ├── integration/
│   └── e2e/
│
├── .env.example
├── package.json
├── tsconfig.json
├── .gitignore
└── README.md