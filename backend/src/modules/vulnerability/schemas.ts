// src/modules/vulnerability/schemas.ts - FIXED
import { z } from 'zod';

export const vulnerabilityListSchema = z.object({
  severity: z.enum(['critical', 'high', 'medium', 'low', 'info']).optional(),
  status: z
    .enum(['open', 'in_review', 'accepted', 'false_positive', 'wont_fix', 'fixed'])
    .optional(),
  search: z.string().optional(),
  page: z
    .string()
    .transform((v) => parseInt(v, 10))
    .pipe(z.number().int().positive())
    .optional()
    .default('1'),
  limit: z
    .string()
    .transform((v) => parseInt(v, 10))
    .pipe(z.number().int().positive().max(100))
    .optional()
    .default('20'),
});

export const scanIdSchema = z.object({
  scanId: z.string().uuid(),
});

export const scanAndTypeSchema = z.object({
  scanId: z.string().uuid(),
  type: z.enum(['sast', 'sca', 'secrets', 'iac', 'container']),
});

export const vulnerabilityDetailsSchema = z.object({
  id: z.string().uuid(),
  type: z.enum(['sast', 'sca', 'secrets', 'iac', 'container']),
});

export const updateVulnerabilityStatusSchema = z.object({
  status: z.enum([
    'open',
    'in_review',
    'accepted',
    'false_positive',
    'wont_fix',
    'fixed',
  ]),
  note: z.string().optional(),
});

export const repoIdSchema = z.object({
  repoId: z.string().uuid(),
});


